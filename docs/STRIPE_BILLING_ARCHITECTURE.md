# Stripe Billing Architecture for Qui Browser VR
## 課金システム設計書

**Version:** 1.0.0
**Date:** 2025-10-25
**Status:** Production Ready

---

## 🎯 課金モデルの設計 (超低価格・ノーサポート戦略)

### ビジネス目標

1. **圧倒的な低価格** - 他社を圧倒する価格設定で市場シェア獲得
2. **ノーサポートによるコスト削減** - サポートコストゼロで利益率最大化
3. **大量ユーザー獲得** - 低価格×高機能で爆発的なユーザー増
4. **完全セルフサービス** - コミュニティドリブンのサポート体制

### 競合比較 (2025年現在)

| サービス | 月額 | 年額 | サポート |
|---------|------|------|---------|
| Meta Quest Browser | 無料 | - | 限定的 |
| Wolvic | 無料 | - | コミュニティ |
| **Qui Browser VR Premium** | **¥200** | **¥2,000** | **なし (FAQ/コミュニティ)** |
| Netflix | ¥1,490 | - | あり |
| Spotify Premium | ¥980 | - | あり |
| YouTube Premium | ¥1,280 | - | あり |

**戦略:** 競合の1/5〜1/7の価格設定で市場を席巻

### 料金プラン構成

#### 1. **Free Tier (無料プラン)** - 制限付き
**月額:** ¥0 / $0
**サポート:** なし (FAQのみ)

**含まれる機能:**
- ✅ 基本的なVRブラウジング (3Dタブマネージャー、ブックマーク)
- ✅ ハンドトラッキング (基本ジェスチャー: ピンチ、グラブ、ポイント)
- ✅ 音声コマンド (日本語、基本コマンドのみ)
- ✅ 環境カスタマイズ (3プリセット)
- ✅ テキスト入力 (仮想キーボードのみ)
- ✅ 動画視聴 (720p、30fps)
- ⏱️ **セッション時間: 30分/日**
- 📺 **広告表示あり** (VR空間内に控えめな広告)

**制限:**
- ❌ Foveated Rendering
- ❌ 高度なジェスチャー (12ジェスチャー制限)
- ❌ Swypeテキスト入力
- ❌ 4K/8K動画
- ❌ クラウド同期
- ❌ 人間工学機能
- ❌ アクセシビリティ機能

#### 2. **Premium Tier (プレミアムプラン)** - 🔥 超低価格！
**月額:** **¥200** / **$1.99** 👈 **他社の1/5の価格！**
**年額:** **¥2,000** / **$19.99** (2ヶ月分無料、17%割引)
**サポート:** **なし** (FAQ、コミュニティフォーラム、GitHub Issuesのみ)

**🎉 すべての機能アンロック:**
- ✅ **Foveated Rendering (FFR)** - 25-50% GPU削減
- ✅ **高度なハンドジェスチャー** - 15種類すべて
- ✅ **Swypeテキスト入力** - 2-3倍高速 (34.2 WPM)
- ✅ **視線追跡キーボード** - 12 WPM ハンズフリー (Quest Pro)
- ✅ **Eye-Tracked Foveated Rendering (ETFR)** - 36-52% GPU削減 (Quest Pro)
- ✅ **4K動画視聴** - 60fps
- ✅ **8K動画視聴** - 30fps (Quest 3)
- ✅ **人間工学機能フル** - 20-20-20ルール、瞬き監視
- ✅ **モーションアクセシビリティ** - 全プロファイル (車椅子対応)
- ✅ **クラウド同期** - ブックマーク、設定、履歴
- ✅ **広告完全非表示**
- ✅ **AI機能** - 画面読み上げ、要約、レコメンデーション
- ✅ **マルチプレイヤーVR** - 最大10人同時接続
- ⏱️ **セッション時間: 完全無制限**

**価格設定理由:**
- **サポートコストゼロ** → 運営コスト最小化
- **完全自動化** → 人件費ゼロ
- **大量ユーザー獲得** → 薄利多売モデル
- **競合の1/5** → Netflix (¥1,490), Spotify (¥980) より圧倒的に安い
- **年間¥2,000** → 1日あたりたったの¥5.5 (缶コーヒー半分以下)

#### 3. **Business Tier (ビジネスプラン)** - 法人向け
**月額:** **¥50,000〜** / **$499〜** (ユーザー数による従量課金)
**年額:** **¥500,000〜** / **$4,999〜** (2ヶ月分無料)
**サポート:** **メールサポートあり** (営業日48時間以内返信)

**Premiumの全機能 + 以下:**
- ✅ **カスタムブランディング** (ロゴ、色、環境)
- ✅ **SSO統合** (Azure AD, Okta, Google Workspace)
- ✅ **チーム管理ダッシュボード** (ユーザー管理、権限設定)
- ✅ **使用状況分析** (詳細レポート、CSV/PDF出力)
- ✅ **専用インスタンス** (オプション、要相談)
- ✅ **SLA保証** (99.5% uptime)
- ✅ **請求書払い** (法人請求書発行)
- ✅ **メールサポート** (営業日48時間以内)

**対象顧客:**
- 企業・法人 (10人以上)
- 教育機関
- コワーキングスペース
- VRアーケード施設

---

## 💰 使用量ベース課金 (Add-ons) - 廃止

**超低価格戦略により、アドオン課金は廃止しました。**

### 理由:
1. **シンプルな価格体系** - ¥200で全部込み、追加課金なし
2. **コスト削減** - 従量課金の管理コストを削減
3. **ユーザー体験向上** - 予測可能な料金、請求の複雑さゼロ

### Premiumプランに含まれる容量:
- **ストレージ:** 10GB (追加不可)
- **AI機能:** 月間500リクエスト (追加不可)
- **マルチプレイヤー:** 無制限 (接続人数のみ制限: 10人)
- **カスタム環境:** 3環境まで作成可能

### Business Tierの容量:
- **ストレージ:** 1TB (チーム共有)
- **AI機能:** 無制限
- **マルチプレイヤー:** 無制限 (100人まで)
- **カスタム環境:** 無制限

---

## 🏗️ 技術アーキテクチャ

### Stripe製品の使用

#### 1. **Stripe Checkout**
- 決済ページホスティング (セキュア、PCI DSS準拠)
- 多通貨対応 (USD, JPY, EUR, GBP等)
- 複数の決済手段 (クレジットカード、デビットカード、Apple Pay、Google Pay)

#### 2. **Stripe Billing (Subscriptions)**
- サブスクリプション管理
- 自動請求
- プラン変更 (アップグレード/ダウングレード)
- 日割り計算
- トライアル期間 (14日間無料)

#### 3. **Stripe Customer Portal**
- セルフサービス管理
- 請求書ダウンロード
- 支払い方法更新
- サブスクリプションキャンセル

#### 4. **Stripe Webhooks**
- リアルタイムイベント処理
- サブスクリプション更新通知
- 支払い成功/失敗
- 顧客ステータス変更

#### 5. **Stripe Tax**
- 自動税計算 (消費税、VAT、州税)
- 税務コンプライアンス自動化

---

## 🔄 ユーザーフロー

### 新規ユーザー登録フロー

```
1. VRブラウザ起動 (Free Tierで利用開始)
   ↓
2. Premium機能を試す (14日間無料トライアル)
   ↓
3. Stripe Checkoutで支払い情報入力
   ↓
4. サブスクリプション開始
   ↓
5. Premium機能アンロック
```

### プラン変更フロー

```
1. VR内の設定メニュー → "サブスクリプション管理"
   ↓
2. Stripe Customer Portal へリダイレクト
   ↓
3. プラン変更選択 (即座反映 or 次回更新時)
   ↓
4. 確認 → 変更完了
   ↓
5. VRブラウザに反映 (Webhook経由)
```

### キャンセルフロー

```
1. Customer Portal → "サブスクリプションをキャンセル"
   ↓
2. キャンセル理由選択 (フィードバック収集)
   ↓
3. オファー提示 (1ヶ月50%オフ等)
   ↓
4. キャンセル確定 or 継続
   ↓
5. 期間終了まで利用可能 → Free Tierにダウングレード
```

---

## 🛡️ セキュリティ設計

### 1. **PCI DSS準拠**
- カード情報は一切サーバーに保存しない
- Stripe Checkoutで全決済処理
- Stripe.js (Elements) 使用でトークン化

### 2. **認証・認可**
- JWT (JSON Web Token) でユーザー認証
- サブスクリプションステータスをJWTに含める
- サーバーサイドで常に検証

### 3. **Webhook署名検証**
- Stripe署名ヘッダー検証 (HMAC SHA256)
- タイムスタンプ検証 (リプレイ攻撃防止)
- ホワイトリストIPからのみ受信

### 4. **データ暗号化**
- データベース暗号化 (AES-256)
- HTTPS通信 (TLS 1.3)
- 顧客IDの難読化

---

## 📊 分析・メトリクス

### ビジネスKPI

1. **MRR (Monthly Recurring Revenue)** - 月次定期収益
2. **ARR (Annual Recurring Revenue)** - 年次定期収益
3. **Churn Rate** - 解約率 (目標: <5%)
4. **ARPU (Average Revenue Per User)** - ユーザーあたり平均収益
5. **LTV (Lifetime Value)** - 顧客生涯価値
6. **CAC (Customer Acquisition Cost)** - 顧客獲得コスト
7. **Conversion Rate** - Free → Premium 転換率 (目標: 5-10%)

### 技術メトリクス

1. **Checkout完了率** (目標: >80%)
2. **決済成功率** (目標: >95%)
3. **Webhook処理遅延** (目標: <500ms)
4. **API応答時間** (目標: <200ms)

---

## 🌍 国際化対応

### 通貨対応

- **日本円 (JPY)** - 日本市場
- **米ドル (USD)** - 北米・グローバル
- **ユーロ (EUR)** - ヨーロッパ
- **英ポンド (GBP)** - イギリス
- **韓国ウォン (KRW)** - 韓国市場

### 価格ローカライズ

| プラン | 日本 (JPY) | 米国 (USD) | EU (EUR) | 英国 (GBP) |
|--------|-----------|-----------|----------|-----------|
| Premium (月) | **¥200** | **$1.99** | **€1.99** | **£1.79** |
| Premium (年) | **¥2,000** | **$19.99** | **€19.99** | **£17.99** |
| Business (月) | ¥50,000〜 | $499〜 | €499〜 | £449〜 |
| Business (年) | ¥500,000〜 | $4,999〜 | €4,999〜 | £4,499〜 |

### 税金対応

- **日本:** 消費税 10% (自動加算)
- **EU:** VAT (国によって異なる、Stripeが自動計算)
- **米国:** 州税 (該当州のみ)

---

## 📱 VR-Native UI/UX

### 1. **VR内決済フロー**

```javascript
// VR空間内での3Dモーダル表示
showSubscriptionModal() {
  // 3つのプラン比較カード (Free, Premium, Business)
  // Free: グレー、Premium: ブルー (おすすめバッジ)、Business: ゴールド

  // 価格表示 (大きく強調)
  // Premium: "¥200/月" "1日あたりたったの¥6.7"

  // 機能一覧 (チェックマーク付き)
  // "サポートなし (FAQ/コミュニティのみ)" を明記

  // "14日間無料で試す" ボタン (3Dボタン、ハンドジェスチャーで選択)
}
```

### 2. **支払い確認通知**

```
VR空間内通知:
「✅ Premiumプランへようこそ！
 すべての機能がアンロックされました」

(3D通知が3秒間表示、自動的にフェードアウト)
```

### 3. **サブスクリプション管理UI**

```
VR Settings → Subscription:
- 現在のプラン表示 (Premium/Business バッジ)
- 次回更新日
- 使用量メーター (ストレージ、AI使用量等)
- "Businessプランへアップグレード" ボタン (Premiumユーザーのみ)
- "請求履歴" ボタン
- "キャンセル" ボタン

注: サポートは提供していないため、"お問い合わせ" ボタンはなし
代わりに "FAQ" と "コミュニティフォーラム" へのリンク
```

---

## 🚀 実装フェーズ

### Phase 1: 基本課金システム (2週間)
- ✅ Stripe Checkout統合
- ✅ サブスクリプション作成 (Premium, Business)
- ✅ Webhook処理 (基本イベント)
- ✅ データベーススキーマ設計

### Phase 2: VR-Native UI (1週間)
- ✅ VR内決済モーダル (3プラン比較: Free, Premium, Business)
- ✅ プラン比較UI (¥200強調表示)
- ✅ サブスクリプション管理画面

### Phase 3: セルフサービス機能 (1週間)
- ✅ Customer Portal統合
- ✅ FAQ/コミュニティフォーラムリンク
- ✅ アップグレード/ダウングレード

### Phase 4: ビジネスTier機能 (3週間)
- ✅ SSO統合
- ✅ チーム管理
- ✅ カスタム契約
- ✅ メールサポートシステム (Business Tierのみ)

---

## 💡 収益予測 (超低価格・大量ユーザー戦略)

### 保守的シナリオ (1年後) - 低価格で転換率2倍

| ユーザー層 | ユーザー数 | ARPU (月) | MRR | ARR |
|-----------|----------|----------|-----|-----|
| Free | 20,000 | ¥0 | ¥0 | ¥0 |
| Premium | 2,000 (10%) | **¥200** | **¥400,000** | **¥4,800,000** |
| Business | 3 | ¥100,000 | ¥300,000 | ¥3,600,000 |
| **合計** | **22,003** | **¥32** | **¥700,000** | **¥8,400,000** |

**戦略:** 低価格 (¥200) により、転換率を5% → 10%に倍増

### 楽観的シナリオ (1年後) - 爆発的ユーザー増

| ユーザー層 | ユーザー数 | ARPU (月) | MRR | ARR |
|-----------|----------|----------|-----|-----|
| Free | 100,000 | ¥0 | ¥0 | ¥0 |
| Premium | 20,000 (20%) | **¥200** | **¥4,000,000** | **¥48,000,000** |
| Business | 15 | ¥200,000 | ¥3,000,000 | ¥36,000,000 |
| **合計** | **120,015** | **¥58** | **¥7,000,000** | **¥84,000,000** |

**戦略:** 圧倒的低価格により転換率20%達成、ユーザー数10倍増

### 超楽観的シナリオ (2年後) - 市場支配

| ユーザー層 | ユーザー数 | ARPU (月) | MRR | ARR |
|-----------|----------|----------|-----|-----|
| Free | 500,000 | ¥0 | ¥0 | ¥0 |
| Premium | 100,000 (20%) | **¥200** | **¥20,000,000** | **¥240,000,000** |
| Business | 50 | ¥300,000 | ¥15,000,000 | ¥180,000,000 |
| **合計** | **600,050** | **¥58** | **¥35,000,000** | **¥420,000,000** |

**戦略:** Netflix級の50万ユーザー獲得、年間4.2億円収益

---

## ✅ 成功要因 (超低価格・ノーサポート戦略)

1. **圧倒的な低価格** - ¥200/月 = 競合の1/5〜1/7、心理的ハードル完全除去
2. **無料プランの魅力** - 30分/日でも十分使える、広告も控えめ
3. **明確な価値提案** - ¥200で全機能アンロック、分かりやすい
4. **スムーズなアップグレード** - VR内で簡単に課金可能、14日間無料
5. **継続的な価値提供** - 新機能を定期的にリリース
6. **完全セルフサービス** - FAQ/コミュニティで90%以上の問題解決
7. **データドリブン改善** - メトリクス分析による継続的改善
8. **薄利多売モデル** - 低利益率でも大量ユーザーで収益確保
9. **運営コスト最小化** - サポートゼロ、完全自動化、人件費ゼロ
10. **バイラル成長** - 低価格により口コミ拡散、SNSでシェア増

---

**ドキュメントバージョン:** 1.0.0
**最終更新:** 2025-10-25
**作成者:** Qui Browser VR Team
