# सुरक्षा आधाररेखा (हिन्दी)

## खतरा मॉडल

- **सर्वर सतह**: `server-lightweight.js` REST API और स्थिर फ़ाइलें प्रदान करता
  है।
- **स्थायी डेटा**: एक्सटेंशन मेटाडेटा (`data/extensions.json`), ब्राउज़र सत्र और
  सदस्यता रजिस्टर (`data/subscriptions.json`)।
- **परिवहन डेटा**: VR क्लाइंट ट्रैफिक और Stripe Webhook कॉल।

## हार्डनिंग चेकलिस्ट

- **TLS समाप्ति**: HTTPS रिवर्स प्रॉक्सी या लोड बैलेंसर के पीछे सर्वर चलाएँ।
- **होस्ट सत्यापन**: `.env` में `ALLOWED_HOSTS` सेट करें; `validateHostHeader()`
  अनधिकृत होस्ट को अस्वीकार करता है।
- **कठोर CORS**: `parseAllowedOrigins()` श्वेतसूची आधारित उत्पत्ति नियंत्रण लागू
  करता है।
- **रेट लिमिटिंग**: `checkRateLimit()` स्लाइडिंग विंडो के माध्यम से दुरुपयोग
  रोकता है।
- **स्थिर फ़ाइल सुरक्षा**: `serveStaticFile()` पथ सामान्यीकृत करता है और
  प्रतीकात्मक लिंक की जाँच करता है।
- **संपीड़न नीति**: `utils/compression.js` सीमित MIME प्रकार पर संपीड़न लागू कर
  BREACH जोखिम घटाता है।

## Stripe कुंजी प्रबंधन

- `STRIPE_SECRET_KEY` और `STRIPE_WEBHOOK_SECRET` को सुरक्षित रहस्य प्रबंधक में
  रखें।
- कुंजियों को नियमित रूप से बदलें और CI/CD चर अद्यतन करें।
- Webhook केवल HTTPS पर स्वीकारें और हस्ताक्षर सत्यापन विफलताएँ मॉनिटर करें।

## घटना प्रतिक्रिया

1. समझौते की आशंका होने पर ट्रैफ़िक रोकें या कुंजियाँ निरस्त करें।
2. `logs/` में सर्वर लॉग और Stripe डैशबोर्ड इवेंट जाँचें।
3. आवश्यकता होने पर `backups/` से पुनर्स्थापित करें और `npm test` से सत्यापित
   करें।
4. सुधार लागू करें, पुनः परिनियोजित करें, हितधारकों को सूचित करें और
   पोस्ट-मोर्टेम दर्ज करें।

## अनुपालन संकेत

- VR ब्राउज़िंग इतिहास तथा सदस्यता डेटा के संरक्षण नियम दस्तावेजित करें।
- GDPR/CCPA जैसी गोपनीयता विधियों के अनुरूप सहमति लॉग बनाए रखें।
- प्रत्येक एकीकरण पर `npm run security:scan` चलाएँ और परिणाम संरक्षित करें।
