<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qui Browser VR - Multilingual Integration Demo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      color: #fff;
      direction: ltr;
    }

    body[dir="rtl"] {
      direction: rtl;
    }

    .container {
      max-width: 1200px;
      width: 100%;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      text-align: center;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .subtitle {
      text-align: center;
      font-size: 1.2rem;
      margin-bottom: 30px;
      opacity: 0.9;
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .control-group {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 10px;
    }

    .control-group label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    select, button, input {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      outline: none;
      transition: all 0.3s;
    }

    select {
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      cursor: pointer;
    }

    select:hover {
      background: rgba(255, 255, 255, 1);
    }

    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      cursor: pointer;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-top: 10px;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    button:active {
      transform: translateY(0);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .status {
      background: rgba(0, 0, 0, 0.3);
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
    }

    .status-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .status-item:last-child {
      border-bottom: none;
    }

    .status-label {
      font-weight: 600;
      opacity: 0.8;
    }

    .status-value {
      font-family: 'Courier New', monospace;
      color: #4ade80;
    }

    .demo-section {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
    }

    .demo-section h2 {
      margin-bottom: 15px;
      font-size: 1.5rem;
    }

    .translation-demo {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }

    .translation-item {
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }

    .translation-key {
      font-size: 0.8rem;
      opacity: 0.7;
      margin-bottom: 5px;
      font-family: 'Courier New', monospace;
    }

    .translation-value {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .voice-command-demo {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 15px;
    }

    .voice-status {
      background: rgba(0, 0, 0, 0.3);
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      font-size: 1.2rem;
      font-weight: 600;
    }

    .voice-status.listening {
      background: rgba(74, 222, 128, 0.3);
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    .command-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
    }

    .command-item {
      background: rgba(255, 255, 255, 0.1);
      padding: 10px;
      border-radius: 6px;
      text-align: center;
      font-size: 0.9rem;
    }

    .activity-log {
      background: rgba(0, 0, 0, 0.3);
      padding: 15px;
      border-radius: 8px;
      max-height: 200px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
    }

    .log-entry {
      padding: 5px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .log-entry:last-child {
      border-bottom: none;
    }

    .log-time {
      color: #a78bfa;
      margin-right: 10px;
    }

    .log-event {
      color: #4ade80;
      margin-right: 10px;
    }

    .metrics {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }

    .metric-card {
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }

    .metric-value {
      font-size: 2rem;
      font-weight: 700;
      color: #4ade80;
      margin: 10px 0;
    }

    .metric-label {
      font-size: 0.85rem;
      opacity: 0.8;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .footer {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      font-size: 0.9rem;
      opacity: 0.8;
    }

    /* RTL Adjustments */
    body[dir="rtl"] .status-item {
      flex-direction: row-reverse;
    }

    body[dir="rtl"] .log-time,
    body[dir="rtl"] .log-event {
      margin-right: 0;
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 data-i18n="demo.title">üåç Multilingual VR Browser Demo</h1>
    <p class="subtitle" data-i18n="demo.subtitle">100+ Language Support with Voice Commands</p>

    <!-- Controls -->
    <div class="controls">
      <div class="control-group">
        <label data-i18n="settings.language">Language</label>
        <select id="language-select">
          <option value="en">English</option>
          <option value="ja">Êó•Êú¨Ë™û (Japanese)</option>
          <option value="zh">‰∏≠Êñá (Chinese)</option>
          <option value="es">Espa√±ol (Spanish)</option>
          <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (Arabic)</option>
          <option value="fr">Fran√ßais (French)</option>
          <option value="de">Deutsch (German)</option>
          <option value="ko">ÌïúÍµ≠Ïñ¥ (Korean)</option>
          <option value="ru">–†—É—Å—Å–∫–∏–π (Russian)</option>
          <option value="pt">Portugu√™s (Portuguese)</option>
        </select>
      </div>

      <div class="control-group">
        <label data-i18n="accessibility.voiceCommands">Voice Commands</label>
        <button id="voice-toggle" data-i18n="voice.start">Start Voice Recognition</button>
        <button id="test-command" data-i18n="voice.testCommand">Test Command</button>
      </div>

      <div class="control-group">
        <label data-i18n="demo.testTranslation">Test Translation</label>
        <input type="text" id="translation-key" placeholder="common.ok" data-i18n-placeholder="demo.enterKey">
        <button id="translate-btn" data-i18n="common.search">Translate</button>
      </div>
    </div>

    <!-- Status -->
    <div class="status">
      <div class="status-item">
        <span class="status-label" data-i18n="status.currentLanguage">Current Language:</span>
        <span class="status-value" id="current-language">-</span>
      </div>
      <div class="status-item">
        <span class="status-label" data-i18n="status.locale">Locale:</span>
        <span class="status-value" id="current-locale">-</span>
      </div>
      <div class="status-item">
        <span class="status-label" data-i18n="status.rtl">RTL Mode:</span>
        <span class="status-value" id="rtl-mode">-</span>
      </div>
      <div class="status-item">
        <span class="status-label" data-i18n="status.voiceListening">Voice Listening:</span>
        <span class="status-value" id="voice-status">-</span>
      </div>
    </div>

    <!-- Translation Demo -->
    <div class="demo-section">
      <h2 data-i18n="demo.translationDemo">Translation Demo</h2>
      <div class="translation-demo">
        <div class="translation-item">
          <div class="translation-key">common.ok</div>
          <div class="translation-value" data-i18n="common.ok">OK</div>
        </div>
        <div class="translation-item">
          <div class="translation-key">common.cancel</div>
          <div class="translation-value" data-i18n="common.cancel">Cancel</div>
        </div>
        <div class="translation-item">
          <div class="translation-key">vr.enterVR</div>
          <div class="translation-value" data-i18n="vr.enterVR">Enter VR</div>
        </div>
        <div class="translation-item">
          <div class="translation-key">tabs.newTab</div>
          <div class="translation-value" data-i18n="tabs.newTab">New Tab</div>
        </div>
        <div class="translation-item">
          <div class="translation-key">browser.forward</div>
          <div class="translation-value" data-i18n="browser.forward">Forward</div>
        </div>
        <div class="translation-item">
          <div class="translation-key">settings.settings</div>
          <div class="translation-value" data-i18n="settings.settings">Settings</div>
        </div>
      </div>
    </div>

    <!-- Voice Command Demo -->
    <div class="demo-section">
      <h2 data-i18n="demo.voiceCommandDemo">Voice Command Demo</h2>
      <div class="voice-command-demo">
        <div class="voice-status" id="voice-feedback">
          <span data-i18n="voice.speakCommand">Say a command like "new tab" or "forward"</span>
        </div>
        <div class="command-list" id="command-list">
          <!-- Commands will be populated dynamically -->
        </div>
      </div>
    </div>

    <!-- Metrics -->
    <div class="demo-section">
      <h2 data-i18n="demo.metrics">Performance Metrics</h2>
      <div class="metrics">
        <div class="metric-card">
          <div class="metric-label" data-i18n="metrics.translationSpeed">Translation Speed</div>
          <div class="metric-value" id="metric-speed">-</div>
        </div>
        <div class="metric-card">
          <div class="metric-label" data-i18n="metrics.cacheHitRate">Cache Hit Rate</div>
          <div class="metric-value" id="metric-cache">-</div>
        </div>
        <div class="metric-card">
          <div class="metric-label" data-i18n="metrics.voiceAccuracy">Voice Accuracy</div>
          <div class="metric-value" id="metric-voice">-</div>
        </div>
        <div class="metric-card">
          <div class="metric-label" data-i18n="metrics.languagesLoaded">Languages Loaded</div>
          <div class="metric-value" id="metric-languages">-</div>
        </div>
      </div>
    </div>

    <!-- Activity Log -->
    <div class="demo-section">
      <h2 data-i18n="demo.activityLog">Activity Log</h2>
      <div class="activity-log" id="activity-log">
        <!-- Log entries will be added here -->
      </div>
    </div>

    <div class="footer">
      <p>Qui Browser VR v3.6.0 - 100+ Language Support üåç</p>
      <p data-i18n="demo.footer">Powered by Claude Code</p>
    </div>
  </div>

  <!-- Scripts -->
  <script src="../assets/js/vr-i18n-system.js"></script>
  <script src="../assets/js/vr-voice-commands-i18n.js"></script>
  <script>
    // Global instances
    let i18n;
    let voiceI18n;
    let activityLog = [];

    // Initialize
    async function initialize() {
      try {
        logActivity('System', 'Initializing i18n system...');

        // Initialize i18n
        i18n = new VRI18nSystem();
        await i18n.initialize({
          defaultLanguage: 'en',
          autoDetect: true,
          cacheTranslations: true
        });

        logActivity('i18n', `Initialized with language: ${i18n.getCurrentLanguage()}`);

        // Initialize voice commands
        voiceI18n = new VRVoiceCommandsI18n();
        await voiceI18n.initialize(i18n.getCurrentLanguage());

        logActivity('Voice', `Voice commands initialized for: ${i18n.getCurrentLanguage()}`);

        // Setup event listeners
        setupEventListeners();

        // Update UI
        updateUI();
        updateStatus();
        updateMetrics();
        populateCommandList();

        logActivity('System', 'Initialization complete ‚úì');

      } catch (error) {
        console.error('Initialization error:', error);
        logActivity('Error', `Initialization failed: ${error.message}`);
      }
    }

    // Setup event listeners
    function setupEventListeners() {
      // Language selector
      document.getElementById('language-select').addEventListener('change', async (e) => {
        const newLang = e.target.value;
        logActivity('User', `Changing language to: ${newLang}`);
        await i18n.setLanguage(newLang);
      });

      // i18n events
      i18n.addEventListener('languageChanged', (event) => {
        logActivity('i18n', `Language changed: ${event.detail.oldLanguage} ‚Üí ${event.detail.newLanguage}`);
        logActivity('i18n', `RTL mode: ${event.detail.isRTL}`);

        // Update voice commands language
        voiceI18n.switchLanguage(event.detail.newLanguage);

        // Update UI
        updateUI();
        updateStatus();
        populateCommandList();

        // Update document direction
        document.body.dir = event.detail.isRTL ? 'rtl' : 'ltr';
      });

      // Voice toggle
      document.getElementById('voice-toggle').addEventListener('click', () => {
        if (voiceI18n.state.listening) {
          voiceI18n.stopListening();
          logActivity('Voice', 'Stopped listening');
        } else {
          voiceI18n.startListening();
          logActivity('Voice', 'Started listening');
        }
        updateStatus();
      });

      // Test command
      document.getElementById('test-command').addEventListener('click', () => {
        const commands = ['navigate_forward', 'tab_new', 'search', 'help'];
        const randomCommand = commands[Math.floor(Math.random() * commands.length)];
        logActivity('Test', `Simulating command: ${randomCommand}`);
        handleCommand(randomCommand, 0.95);
      });

      // Voice command events
      voiceI18n.addEventListener('started', () => {
        updateVoiceFeedback(i18n.t('voice.listeningForCommand'), true);
        updateStatus();
      });

      voiceI18n.addEventListener('ended', () => {
        updateVoiceFeedback(i18n.t('voice.speakCommand'), false);
        updateStatus();
      });

      voiceI18n.addEventListener('commandRecognized', (event) => {
        const { action, transcript, confidence } = event.detail;
        logActivity('Voice', `Recognized: "${transcript}" ‚Üí ${action} (${(confidence * 100).toFixed(1)}%)`);
        handleCommand(action, confidence);
        updateMetrics();
      });

      voiceI18n.addEventListener('commandNotRecognized', (event) => {
        logActivity('Voice', `Not recognized: "${event.detail.transcript}"`);
        updateVoiceFeedback(i18n.t('voice.commandNotRecognized'), false);
      });

      voiceI18n.addEventListener('error', (event) => {
        logActivity('Error', `Voice error: ${event.detail.error}`);
      });

      // Translate button
      document.getElementById('translate-btn').addEventListener('click', () => {
        const key = document.getElementById('translation-key').value;
        if (key) {
          const translation = i18n.t(key, {}, `[${key}]`);
          logActivity('Translation', `${key} ‚Üí "${translation}"`);
          alert(`${key}:\n${translation}`);
        }
      });
    }

    // Update UI with translations
    function updateUI() {
      // Translate all elements with data-i18n
      document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        element.textContent = i18n.t(key);
      });

      // Translate placeholders
      document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        element.placeholder = i18n.t(key);
      });

      // Update language selector
      document.getElementById('language-select').value = i18n.getCurrentLanguage();

      // Update voice toggle button
      const voiceToggle = document.getElementById('voice-toggle');
      voiceToggle.textContent = voiceI18n && voiceI18n.state.listening
        ? i18n.t('voice.stop')
        : i18n.t('voice.start');
    }

    // Update status display
    function updateStatus() {
      document.getElementById('current-language').textContent = i18n.getCurrentLanguage();
      document.getElementById('current-locale').textContent = i18n.getCurrentLocale();
      document.getElementById('rtl-mode').textContent = i18n.isRTL() ? 'Yes' : 'No';
      document.getElementById('voice-status').textContent = voiceI18n && voiceI18n.state.listening
        ? 'Listening'
        : 'Stopped';
    }

    // Update metrics
    function updateMetrics() {
      const i18nMetrics = i18n.getMetrics();
      const voiceMetrics = voiceI18n.getMetrics();

      document.getElementById('metric-speed').textContent =
        `${i18nMetrics.averageTranslationTime.toFixed(2)}ms`;
      document.getElementById('metric-cache').textContent =
        `${(i18nMetrics.cacheHitRate * 100).toFixed(1)}%`;
      document.getElementById('metric-voice').textContent =
        voiceMetrics.totalCommands > 0
          ? `${voiceMetrics.successRate.toFixed(1)}%`
          : '-';
      document.getElementById('metric-languages').textContent =
        i18nMetrics.languagesLoaded;
    }

    // Populate command list
    function populateCommandList() {
      const commandList = document.getElementById('command-list');
      const commands = [
        'navigate_forward',
        'navigate_back',
        'tab_new',
        'tab_close',
        'search',
        'help'
      ];

      commandList.innerHTML = commands.map(cmd => {
        const phrases = voiceI18n.commands.get(cmd);
        const langPhrases = phrases ? phrases.get(i18n.getCurrentLanguage()) : null;
        const examplePhrase = langPhrases ? langPhrases[0] : cmd;

        return `
          <div class="command-item">
            <strong>${cmd.replace('_', ' ')}</strong><br>
            <small>"${examplePhrase}"</small>
          </div>
        `;
      }).join('');
    }

    // Update voice feedback
    function updateVoiceFeedback(text, listening) {
      const feedback = document.getElementById('voice-feedback');
      feedback.textContent = text;
      if (listening) {
        feedback.classList.add('listening');
      } else {
        feedback.classList.remove('listening');
      }
    }

    // Handle voice command
    function handleCommand(action, confidence) {
      updateVoiceFeedback(
        `${i18n.t('voice.commandRecognized').replace('{command}', action)} (${(confidence * 100).toFixed(1)}%)`,
        false
      );

      // Simulate command action
      setTimeout(() => {
        updateVoiceFeedback(i18n.t('voice.speakCommand'), false);
      }, 2000);
    }

    // Log activity
    function logActivity(event, message) {
      const timestamp = new Date().toLocaleTimeString();
      activityLog.unshift({ timestamp, event, message });

      // Keep only last 50 entries
      if (activityLog.length > 50) {
        activityLog = activityLog.slice(0, 50);
      }

      // Update log display
      const logElement = document.getElementById('activity-log');
      logElement.innerHTML = activityLog.map(entry => `
        <div class="log-entry">
          <span class="log-time">${entry.timestamp}</span>
          <span class="log-event">[${entry.event}]</span>
          <span>${entry.message}</span>
        </div>
      `).join('');

      console.log(`[${event}] ${message}`);
    }

    // Initialize on load
    window.addEventListener('DOMContentLoaded', initialize);
  </script>
</body>
</html>
