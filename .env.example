# Qui Browser - 環境変数設定例
# このファイルをコピーして .env として使用してください
# cp .env.example .env

# ==================== 基本設定 ====================

# 実行環境 (development, production)
NODE_ENV=production

# サーバーポート
PORT=8000

# バインドホスト (0.0.0.0: すべてのインターフェース, localhost: ローカルのみ)
HOST=0.0.0.0

# プロキシ信頼設定（ロードバランサー/プロキシ使用時はtrue）
TRUST_PROXY=false

# ==================== セキュリティ設定 ====================

# 監査ログ署名キー（必須！32文字以上のランダムな文字列）
# 生成方法: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
AUDIT_SIGNATURE_KEY=change-this-to-a-secure-random-key-minimum-32-characters

# HTTPS有効化
ENABLE_HTTPS=false

# TLS証明書パス（HTTPS有効時）
TLS_CERT_PATH=./certs/cert.pem
TLS_KEY_PATH=./certs/key.pem

# CORS設定（カンマ区切りで複数ドメイン指定可能）
# 例: https://example.com,https://app.example.com
# "*" は本番環境では使用しないでください
ALLOWED_ORIGINS=https://your-domain.com

# ==================== セッション管理 ====================

# セッションタイムアウト（ミリ秒）
# 3600000 = 1時間
SESSION_TIMEOUT=3600000

# ユーザーあたりの最大セッション数
MAX_SESSIONS_PER_USER=5

# ==================== キャッシング設定 ====================

# キャッシュ最大サイズ（エントリ数）
CACHE_MAX_SIZE=10000

# キャッシュTTL（ミリ秒）
# 300000 = 5分
CACHE_TTL=300000

# キャッシュ戦略 (lru, lfu, ttl, adaptive)
CACHE_STRATEGY=adaptive

# 最大メモリ使用量（バイト）
# 1073741824 = 1GB
CACHE_MAX_MEMORY=1073741824

# ==================== DDoS保護 ====================

# クライアントからのgzip圧縮ボディを許可する場合はtrue
ALLOW_GZIP_REQUESTS=false

# 静的ファイル圧縮キャッシュ設定
STATIC_COMPRESSION_CACHE_MAX_SIZE=200
STATIC_COMPRESSION_CACHE_TTL_MS=600000

# IPあたりの最大同時接続数
DDOS_MAX_CONNECTIONS_PER_IP=10

# ブラックリスト期間（ミリ秒）
# 3600000 = 1時間
DDOS_BLACKLIST_DURATION=3600000

# ==================== 機能有効化 ====================

# パフォーマンスプロファイリングを有効化
ENABLE_PROFILING=true

# 監査ログを有効化
ENABLE_AUDIT_LOG=true

# リクエスト重複排除を有効化
ENABLE_DEDUPLICATION=true

# ==================== ログ設定 ====================

# ログディレクトリ
LOG_DIR=./logs

# ログレベル (error, warn, info, debug)
LOG_LEVEL=info

# ログローテーション（日数）
LOG_ROTATION_DAYS=30

# ==================== Redis設定（オプション） ====================

# Redisを使用する場合
# REDIS_URL=redis://localhost:6379
# REDIS_PASSWORD=your-redis-password

# ==================== モニタリング ====================

# Prometheusメトリクスを有効化
ENABLE_PROMETHEUS=true

# ヘルスチェック間隔（ミリ秒）
HEALTH_CHECK_INTERVAL=30000

# ==================== パフォーマンス設定 ====================

# 圧縮閾値（バイト、この値以上のレスポンスを圧縮）
COMPRESSION_THRESHOLD=1024

# リクエストキュー最大サイズ
REQUEST_QUEUE_MAX_SIZE=1000

# バッチサイズ
REQUEST_BATCH_SIZE=10

# バッチ遅延（ミリ秒）
REQUEST_BATCH_DELAY=100

# ==================== リトライ設定 ====================

# 最大リトライ回数
MAX_RETRIES=3

# 初期遅延（ミリ秒）
INITIAL_RETRY_DELAY=100

# 最大遅延（ミリ秒）
MAX_RETRY_DELAY=5000

# ==================== タイムアウト設定 ====================

# リクエストタイムアウト（ミリ秒）
REQUEST_TIMEOUT=30000

# グレースフルシャットダウンタイムアウト（ミリ秒）
SHUTDOWN_TIMEOUT=30000

# ==================== 開発設定 ====================

# デバッグモード
# DEBUG=qui:*

# ホットリロード（開発環境のみ）
# HOT_RELOAD=true

# ==================== テスト設定 ====================

# テスト環境用ポート
# TEST_PORT=8001

# テスト環境用データベース
# TEST_DATABASE_URL=postgresql://localhost:5432/qui_browser_test

# ==================== 決済・課金設定（Stripe） ====================

# 管理者認証トークン（必須！32文字以上のランダムな文字列）
# 生成方法: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
BILLING_ADMIN_TOKEN=change-this-to-a-secure-random-admin-token-minimum-32-characters

# Stripe APIキー
# テストモード: https://dashboard.stripe.com/test/apikeys
# 本番モード: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key_here
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key_here

# Stripe Webhook シークレット
# https://dashboard.stripe.com/webhooks で取得
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# Stripe Price ID（ロケールごと）
# プライスIDは Stripe Dashboard の Products セクションで確認
# 複数ロケールに対応する場合は、以下のようにカンマ区切りで設定
# STRIPE_PRICE_ID_DEFAULT=price_xxxxxxxxxxxx
# STRIPE_PRICE_ID_EN=price_xxxxxxxxxxxx
# STRIPE_PRICE_ID_JA_JP=price_xxxxxxxxxxxx
STRIPE_PRICE_ID_DEFAULT=price_1234567890abcdefgh

# 決済完了時のリダイレクトURL
STRIPE_SUCCESS_URL=https://your-domain.com/billing/success
STRIPE_CANCEL_URL=https://your-domain.com/billing/cancel

# 商品名（任意）
STRIPE_PRODUCT_NAME=Qui Browser Premium

# 課金機能を有効化
ENABLE_BILLING=false

# ==================== 注意事項 ====================

# 1. AUDIT_SIGNATURE_KEY は必ず変更してください
# 2. 本番環境では ENABLE_HTTPS=true を推奨
# 3. LOG_LEVEL は本番環境では info または warn を推奨
# 4. キャッシュサイズは利用可能なメモリに応じて調整してください
# 5. セッションタイムアウトはセキュリティ要件に応じて調整してください

# ==================== セキュリティチェックリスト ====================

# □ AUDIT_SIGNATURE_KEY を安全なランダムな値に変更済み
# □ BILLING_ADMIN_TOKEN を安全なランダムな値に変更済み（課金機能使用時）
# □ HTTPS を有効化し、有効な証明書を設定済み
# □ Stripe の本番キーを設定済み（テストキーではない）
# □ Webhook シークレットを正しく設定済み
# □ ファイアウォールで必要なポートのみ開放済み
# □ ログディレクトリのアクセス権限を適切に設定済み
# □ 定期的なセキュリティ更新を実施する計画を策定済み
# □ 決済完了URLが正しいドメインを指している
